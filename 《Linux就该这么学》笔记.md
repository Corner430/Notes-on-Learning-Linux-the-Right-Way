
#### 30. 计划任务服务程序
计划任务分为**一次性计划任务**与**长期性计划任务**
- 一次性计划任务：只执行一次的计划任务，执行完毕后就会自动删除
  - [at: 在指定的时间执行指定的任务](https://wangchujiang.com/linux-command/c/at.html)
  - [atrm: 删除待执行的任务](https://wangchujiang.com/linux-command/c/atrm.html)
- 长期性计划任务：周期性执行的计划任务，执行完毕后不会自动删除
  - [crontab: 定时执行任务](https://wangchujiang.com/linux-command/c/crontab.html)
> 分、时、日、月、星期、命令
> 在crond服务的计划任务参数种，所有命令**一定要用绝对路径**的方式来写，如果不知道绝对路径，可以使用 `whereis` 或者 `which` 命令来查看
> 在crond服务的配置参数中，可以像Shell脚本那样以#开头添加注释，但是注释必须独占一行
> **计划任务中的“分”字段必须有数值，绝对不能为空或是星号（*），而“日”和“星期”字段不能同时使用，否则就会发生冲突**
> crond服务默认调用的是vim编辑器


#### 34. 文件权限与归属
在Linux系统中，一切都被视为文件，包括硬件设备、目录、文本文件、二进制文件等。为了区分不同类型的文件，Linux使用了不同的字符来表示它们的类型。以下是常见的字符及其含义：

1. `-`（短横线）：普通文件
   普通文件包含文本内容或二进制数据，通常用于存储用户数据、配置文件、程序代码等。

2. `d`：目录
   目录是用于组织文件和其他目录的特殊文件类型。它们包含其他文件和子目录。

3. `l`：符号链接（软链接）
   符号链接是指向另一个文件或目录的特殊文件类型，类似于Windows系统中的快捷方式。它们可以跨越文件系统和目录边界。

4. `c`：字符设备文件
   字符设备文件用于与系统中的字符设备进行通信，例如键盘、鼠标等。

5. `b`：块设备文件
   块设备文件用于与系统中的块设备进行通信，例如硬盘驱动器、USB设备等。

6. `p`：命名管道（FIFO）
   命名管道是一种特殊的文件类型，用于在进程之间传递数据。

7. `s`：套接字（Socket）
   套接字是一种特殊的文件类型，用于进程之间的网络通信。

这些字符通常显示在Linux系统中执行`ls -l`命令（或其变体）时文件权限的第一个字符位置。例如，一个文件的权限为 `-rw-r--r--`，**其中第一个字符就是 `-`，表示这是一个普通文件**。

------------------------------------------------

在Linux和类Unix系统中，文件和目录都有三种基本权限，分别是读取（Read）、写入（Write）和执行（Execute）权限。这些权限用于控制用户对**文件和目录**的访问和操作能力。每种权限都可以在三个不同的用户级别上设置：**所有者、所属组和其他用户**。

1. 读权限（Read）：
   - 对于文件：读权限允许用户查看文件的内容。如果没有读权限，则用户无法读取文件的内容。
   - 对于目录：读权限允许用户列出目录中的文件和子目录。如果没有读权限，则用户无法查看目录内容。

2. 写权限（Write）：
   - 对于文件：写权限允许用户修改文件的内容。如果没有写权限，则用户无法修改文件，文件内容将只读。
   - 对于目录：写权限允许用户在目录中创建、删除和重命名文件和子目录。如果没有写权限，则用户无法对目录进行修改。

3. 执行权限（Execute）：
   - 对于文件：执行权限对普通文件无意义，除非它被用作可执行程序。可执行程序必须具有执行权限，以便用户能够运行它们。
   - 对于目录：执行权限允许用户访问目录中的文件和子目录。如果没有执行权限，则用户无法进入目录。

在文件系统中，每个文件和目录都有一个拥有者（所有者）、所属组（组）和其他用户（其他）的权限设置。每种权限可以用数字或符号表示。

数字表示方式：
- 读权限：4
- 写权限：2
- 执行权限：1
- 无权限：0

符号表示方式：
- 读权限：r
- 写权限：w
- 执行权限：x
- 无权限：-

例如，`-rw-r--r--` 表示一个文件，所有者有读写权限，所属组和其他用户只有读权限。

要更改文件或目录的权限，可以使用`chmod`命令。例如，要将文件的权限设置为 `-rw-r--r--`，可以使用以下命令：`chmod 644 filename`。

------------------------------------------------
`ls -l` 是一个在Linux和类Unix系统中用于列出文件和目录的命令，它会以长格式（long format）显示文件的详细信息，包括文件的权限、所有者、所属组、大小、修改日期等。

输出的每一行代表一个文件或目录，具体的输出格式如下：

```
-rwxr-xr-x 1 username groupname size date filename
```

这里对输出进行逐个解释：

1. `-rwxr-xr-x`：这是文件的权限字段，显示了文件所有者、所属组和其他用户的权限。
   - 第一个字符表示文件类型：`-`表示普通文件，`d`表示目录，`l`表示符号链接，`b`表示块设备，`c`表示字符设备，`p`表示命名管道（FIFO），`s`表示套接字（socket）等。
   - 接下来的三个字符（`rwx`）表示文件所有者（owner）的读、写和执行权限。
   - 接着的三个字符（`r-x`）表示文件所属组（group）的读、写和执行权限。
   - 最后的三个字符（`r-x`）表示其他用户的读、写和执行权限。

2. `1`：这是链接计数，表示指向该文件或目录的硬链接数量。

3. `username`：这是文件的所有者，表示该文件属于哪个用户。

4. `groupname`：这是文件的所属组，表示该文件属于哪个用户组。

5. `size`：这是文件的大小，以字节为单位。

6. `date`：这是文件的最后修改日期和时间。

7. `filename`：这是文件的名称。

通过`ls -l`命令，你可以查看目录中文件的详细信息，包括权限、所有者、所属组、大小和修改日期等，帮助你更好地了解文件系统的状态和配置。

#### 35. 文件的特殊权限
在Linux系统中，**SUID、SGID和SBIT是用于设置文件或目录特殊权限的三个标志**。这些特殊权限标志可以与文件或目录的权限**一起使用**，以实现特定的权限控制和功能。这些标志在文件和目录的权限字段中以额外的方式表示。

1. SUID（Set User ID）：
   - 对于文件：当SUID标志设置在一个可执行文件上时，**表示在执行该文件时，进程将以文件所有者的权限运行，而不是执行该文件的用户的权限**。
   - 对于目录：在目录上设置SUID标志没有实际作用。

   表示SUID标志的符号是一个小写的 `s`，当没有执行权限时则为大写的 `S`。

2. SGID（Set Group ID）：
   - 对于文件：当SGID标志设置在一个可执行文件上时，**表示在执行该文件时，进程将以文件所属组的权限运行，而不是执行该文件的用户的权限。**
   - 对于目录：当SGID标志设置在一个目录上时，**表示在该目录下新创建的文件和目录将继承该目录的所属组，而不是创建者的默认组**。

   表示SGID标志的符号是一个小写的 `s`，当没有执行权限时则为大写的 `S`。

3. SBIT（Sticky Bit）：
   - 对于目录：当SBIT标志设置在一个目录上时，**表示只有文件的所有者、目录的所有者或超级用户才能删除在此目录下其他用户创建的文件，即保护目录中的文件不被其他非所有者用户删除**。

   表示SBIT标志的符号是一个小写的 `t`，当没有执行权限时则为大写的 `T`。

> 其实，**文件能否被删除并不取决于自身的权限，而是取决于其所在的目录的权限**。如果目录的权限允许用户删除文件，那么用户就可以删除该目录下的任何文件，即使文件的权限不允许用户删除它们。

#### 36. 文件的隐藏属性
Linux 系统中的文件除了具备一般权限和特殊权限之外，还有一种隐藏权限，即被隐藏起来的权限，默认情况下不能直接被用户发觉。
通过 `chattr` 和 `lsattr` 命令可以查看和设置文件的隐藏属性。

#### 37. 文件的访问控制列表
在Linux中，文件访问控制列表（Access Control List，ACL）是一种扩展的权限机制，**允许对文件和目录授予更精细的访问控制**。默认情况下，Linux使用基于所有者、所属组和其他用户的传统权限模型来控制文件和目录的访问权限。但是，有时候这种模型不够灵活，**特别是当涉及到多个用户或组需要不同权限时**，这就是ACL发挥作用的时候。

ACL允许管理员为**单个文件或目录中的多个用户和组设置不同的权限**。ACL可以为特定用户或组分配特定的权限，而不影响文件的其他用户和组的权限。这样，ACL提供了更细粒度的权限控制，增加了系统的灵活性。

基本的Linux文件ACL权限包括：

- `r`：读取权限（read）
- `w`：写入权限（write）
- `x`：执行权限（execute）

在访问控制列表中，每个用户或组可以被授予上述权限的任意组合。要使用ACL，文件系统必须以支持ACL的模式挂载。

常用的ACL相关命令：

1. `getfacl`：查看文件或目录的ACL权限。
2. `setfacl`：设置文件或目录的ACL权限。
3. `chmod`：设置基本权限，ACL权限的基础。

举例说明，假设有一个文件 `example.txt`，我们希望用户A拥有读取和写入权限，用户B拥有读取和执行权限，但是其他用户只能拥有读取权限。这样的ACL权限设置如下：

```
$ setfacl -m u:userA:rw- example.txt
$ setfacl -m u:userB:r-x example.txt
$ setfacl -m o::r-- example.txt
```

通过以上ACL设置，文件 `example.txt` 将具有以下权限：

```
-rw-r-----+ userA userB
```

**其中，`+` 符号表示ACL权限已经启用**。这样，用户A和用户B拥有了不同于其他用户的特定权限。

#### 38. su 命令与 sudo 服务
`su` 切换用户时，`su`命令与用户名之间有一个 `-` 符号，这意味着完全切换到新的用户，即把环境变量信息也变更为新用户的相应信息。

> 当从 `root`管理员切换到普通用户时是不需要密码验证的，但是从普通用户切换到 `root` 管理员时需要密码验证。

-----------------------------------------------------

`visudo`是一个用于编辑`/etc/sudoers`文件的工具，在Linux系统中用于管理`sudo`服务的配置。`sudoers`文件包含了`sudo`服务的配置信息，其中定义了哪些用户或用户组被授权执行特定的命令以及以哪些身份执行这些命令。

使用`visudo`命令来编辑`sudoers`文件是非常重要的，因为该文件的权限设置需要非常谨慎。通过使用`visudo`，可以避免多个用户同时编辑`sudoers`文件导致的冲突，并且在保存后会对文件进行语法检查，以确保修改后的文件格式是正确的。

`visudo`使用了系统默认的文本编辑器，通常是Vi（Vim）编辑器。如果你对Vi编辑器不熟悉，当你执行`visudo`命令后，它会打开`sudoers`文件供你编辑。在`sudoers`文件中，你可以添加或修改用户或用户组的授权规则，指定允许执行哪些命令以及以哪个身份（用户或用户组）执行这些命令。

一些`sudoers`文件的示例配置：

```
# 允许用户A执行所有命令，不需要密码
userA ALL=(ALL) NOPASSWD: ALL

# 允许用户B以root权限执行特定命令，需要密码
userB ALL=(ALL) PASSWD: /usr/bin/command1, /usr/bin/command2

# 允许用户组C以root权限执行所有命令，需要密码
%groupC ALL=(ALL) PASSWD: ALL
```






#### 其它
`chmod u+x example.sh` 和 `chmod +x example.sh` 在大多数情况下是等效的，但它们有一个细微的区别：
1. `chmod u+x example.sh`: 这个指令中的 `u` 表示 "user"，也就是文件的拥有者，通常是当前登录的用户。这条命令会给文件 `example.sh` 的拥有者添加执行权限。
2. `chmod +x example.sh`: 这个指令中的 `+` 表示添加权限，但没有指定权限的接收者。这意味着这条命令会给文件 `example.sh` 的所有用户（拥有者、所属组、其他用户）都添加执行权限。

-----------------------------------------------------------

`dev/null` 是一个特殊的文件，它可以被用于丢弃不需要的输出流，或者作为一个空文件来对输出流重定向。如果希望执行某个命令，但又不希望在屏幕上显示输出结果，那么可以将输出重定向到 `/dev/null` 文件中。

-----------------------------------------------------------

在Linux系统中，`nologin`是一个特殊的系统用户帐户或Shell。它的目的是阻止特定用户登录到系统，并且通常用于防止一些帐户（如系统服务帐户）登录并交互式地执行命令。

主要使用场景包括：

1. 系统服务账户：一些系统服务在安装时会自动创建一个专用的用户帐户，以便安全地运行服务。为了防止这些服务帐户被误用或登录，通常将其登录Shell设置为`nologin`，从而阻止登录。

2. Shell限制：管理员可以将某些用户的Shell设置为`nologin`，以限制他们的登录权限。这可能是出于安全考虑，或者因为这些帐户只需要通过其他方式（如FTP、SCP等）进行访问。

3. 临时禁用帐户：在某些情况下，管理员可能需要暂时禁用用户帐户，而不是永久删除该帐户。将其Shell设置为`nologin`是一种临时禁用帐户的方法。

设置用户的登录Shell为`nologin`通常很简单，可以通过修改`/etc/passwd`文件来实现。管理员只需将用户的Shell字段设置为`/usr/sbin/nologin`或`/sbin/nologin`，具体取决于系统的配置。

> 请注意，`nologin`帐户仅影响交互式登录，而不会影响通过SSH密钥进行的非交互式操作或系统服务的正常运行。

-----------------------------------------------------------
用户的信息保存在`/etc/passwd`文件中，可以直接用文本编辑器来修改其中的用户参数项目，也可以使用`usermod`命令修改已经创建的用户信息。
`usermod` 的 `-d -m` 选项可重新指定用户的家目录**并自动把旧的数据转移过去**。

----------------------------------------------------------
在Linux和其他类Unix系统中，`uid`、`gid`和`groups`是用于标识和管理用户和用户组的概念，用于控制文件访问权限和资源管理。

1. UID（User ID）：
   - UID是用于唯一标识每个用户的整数值。每个用户都有一个独特的UID。
   - 0号UID对应的是超级用户账户，即"root"用户。root用户拥有系统中的最高权限。
   - UID为1至999的UID通常用于系统用户和服务账户，不应该用于一般用户登录。

2. GID（Group ID）：
   - GID是用于唯一标识每个用户组的整数值。每个用户组都有一个独特的GID。
   - 0号GID通常对应于"root"用户组，是系统中超级用户（root用户）的主要用户组。
   - GID为1至999的GID通常用于系统用户组和服务组。

3. Groups（用户组）：
   - 用户组是一组用户的集合，它允许系统管理员将一组用户归类在一起，并在组级别上设置权限。
   - 用户可以属于一个或多个用户组，允许他们共享相同的资源访问权限。
   - 用户组允许更有效地管理用户的权限，而不必为每个用户单独设置权限。

在Linux系统中，可以使用以下命令查看用户的UID、GID以及所属的用户组：

- `id`: 这个命令会显示当前用户的UID、GID以及所属的用户组。
- `groups`: 这个命令会显示当前用户所属的所有用户组。

例如，执行`id`命令可能会得到类似以下的输出：

```
uid=1000(username) gid=1000(username) groups=1000(username),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lxd)
```

这表示当前用户的UID是1000，GID也是1000，同时还属于其他用户组，如adm、cdrom、sudo等。